{% extends "base.html" %}
{% block title %}Formula{% endblock %}
{% block body %}
    <h1>Formula</h1>
    <div class="d-flex flex-row-reverse points">
        <div class="p-2">Wynik: {{ formula.player.formula_points }}</div>
    </div>
    <div class="timer">
        <p>czas:&nbsp</p>
        <span id="timer"></span>
    </div>
    <div class="container formula_question">
        <p>{{ formula.player.formula_answers[0] }} {{ formula.operator }} {{ formula.player.formula_answers[1] }} = {{ formula.result }}</p>
    </div>
    <div class="answer_buttons">
        {% for i in range(4) %}
            <div>
                <a class="btn btn-primary formula_btn" href="{{ url_for("formula_answer", index=i) }}" role="button">{{ formula.all_answers[i] }}</a>
            </div>
        {% endfor %}
    </div>
    <script>
        let timer = document.getElementById('timer');
        let time = timer.innerHTML || {{ time_left }};
        timer.innerHTML = time;
        let countdown = setInterval(function (){
            time--;
            timer.innerHTML = time;
                fetch('http://127.0.0.1:5000/update_time', {
                    method: 'POST',
                    body: JSON.stringify({time_left: time}),
                    headers: {'Content-Type': 'application/json'}
                });
            if(time===0) {
                clearInterval(countdown);
                window.location.replace('http://127.0.0.1:5000/formula/end');
            }
        }, 1000);
    </script>
{% endblock %}
